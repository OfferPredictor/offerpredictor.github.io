<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>美本申请规划方案</title>
    <script src="https://cdn.dhtmlx.com/gantt/edge/dhtmlxgantt.js"></script>
    <link href="https://cdn.dhtmlx.com/gantt/edge/dhtmlxgantt.css" rel="stylesheet">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .gantt_container {
            height: 500px;
            width: 100%;
        }
        .gantt_task_line.waiting {
            background-color: #FFA500;
            border-color: #FF8C00;
        }
        .gantt_task_line.ongoing {
            background-color: #4CAF50;
            border-color: #388E3C;
        }
        .gantt_task_line.completed {
            background-color: #2196F3;
            border-color: #1976D2;
        }
        .controls {
            margin: 20px 0;
        }
        button {
            padding: 8px 16px;
            margin-right: 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .status-legend {
            margin-top: 10px;
        }
        .status-item {
            display: inline-block;
            padding: 4px 8px;
            margin-right: 10px;
            color: white;
            border-radius: 3px;
        }
        .status-waiting { background-color: #FFA500; }
        .status-ongoing { background-color: #4CAF50; }
        .status-completed { background-color: #2196F3; }
    </style>
</head>
<body>
    <div class="container">
        <h1>美本申请规划方案</h1>
        <div class="controls">
            <button onclick="addTask()">添加事项</button>
            <button onclick="removeTask()">删除事项</button>
            <div class="status-legend">
                <span class="status-item status-waiting">待办事项</span>
                <span class="status-item status-ongoing">进行中</span>
                <span class="status-item status-completed">已完成</span>
            </div>
        </div>
        <div id="gantt_here" class="gantt_container"></div>
        <div style="margin-top: 20px;">
            <a href="index.html" style="color: #666; text-decoration: none;">返回首页</a>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 基础配置
            gantt.config.date_format = "%Y-%m-%d";
            gantt.config.scale_height = 50;
            gantt.config.row_height = 30;
            gantt.config.task_height = 20;
            gantt.config.grid_width = 300;

            // 设置时间刻度
            gantt.config.scales = [
                {unit: "year", step: 1, format: "%Y"},
                {unit: "month", step: 1, format: "%M"}
            ];

            // 设置月份名称
            gantt.locale.labels.month_short = [
                "Jan", "Feb", "Mar", "Apr", "May", "Jun", 
                "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"
            ];

            // 设置时间范围
            gantt.config.start_date = new Date(2024, 0, 1);
            gantt.config.end_date = new Date(2024, 11, 31);

            // 设置列
            gantt.config.columns = [
                {name: "text", label: "计划事项", tree: true, width: 200},
                {name: "start_date", label: "开始时间", align: "center", width: 100},
                {name: "end_date", label: "结束时间", align: "center", width: 100}
            ];

            // 任务样式
            gantt.templates.task_class = function(start, end, task) {
                return task.status || "waiting";
            };

            // 初始化
            gantt.init("gantt_here");

            // 加载数据
            var tasks = {
                data: [
                    {id: 1, text: "托福考试", start_date: "2024-01-01", end_date: "2024-03-31", status: "waiting"},
                    {id: 2, text: "SAT考试", start_date: "2024-04-01", end_date: "2024-06-30", status: "waiting"},
                    {id: 3, text: "准备申请", start_date: "2024-07-01", end_date: "2024-12-31", status: "waiting"}
                ]
            };
            gantt.parse(tasks);
        });

        // 添加任务
        function addTask() {
            const taskText = prompt("请输入计划事项名称：");
            if (!taskText) return;

            const startDate = prompt("请输入开始时间（2024年的日期，格式：YYYY-MM-DD）：");
            if (!startDate || !isValidDate(startDate) || new Date(startDate).getFullYear() !== 2024) {
                alert("请输入2024年的有效日期（YYYY-MM-DD格式）");
                return;
            }

            const endDate = prompt("请输入结束时间（2024年的日期，格式：YYYY-MM-DD）：");
            if (!endDate || !isValidDate(endDate) || new Date(endDate).getFullYear() !== 2024) {
                alert("请输入2024年的有效日期（YYYY-MM-DD格式）");
                return;
            }

            if (new Date(endDate) < new Date(startDate)) {
                alert("结束日期不能早于开始日期");
                return;
            }

            const newId = gantt.getTaskByTime().reduce((max, task) => Math.max(max, task.id), 0) + 1;
            gantt.addTask({
                id: newId,
                text: taskText,
                start_date: startDate,
                end_date: endDate,
                status: "waiting"
            });
        }

        // 删除任务
        function removeTask() {
            const selectedId = gantt.getSelectedId();
            if (selectedId) {
                if (confirm("确定要删除这个计划事项吗？")) {
                    gantt.deleteTask(selectedId);
                }
            } else {
                alert("请先选择要删除的计划事项");
            }
        }

        // 双击任务切换状态
        gantt.attachEvent("onTaskDblClick", function(id, e) {
            const task = gantt.getTask(id);
            if (task.status === "waiting") {
                task.status = "ongoing";
            } else if (task.status === "ongoing") {
                task.status = "completed";
            } else {
                task.status = "waiting";
            }
            gantt.updateTask(id);
            return true;
        });

        // 验证日期
        function isValidDate(dateString) {
            const regex = /^\d{4}-\d{2}-\d{2}$/;
            if (!regex.test(dateString)) return false;
            
            const date = new Date(dateString);
            if (!(date instanceof Date) || isNaN(date)) return false;
            
            const [year, month, day] = dateString.split('-').map(Number);
            return month >= 1 && month <= 12 && day >= 1 && day <= 31;
        }
    </script>
</body>
</html> 
</html> 